<div class="container">
  <h3>User Management</h3>
  <p>Manage user accounts, roles, and permissions</p>
  <div style="display: flex; flex-direction: row; gap: 5%">
    <app-activity-card></app-activity-card>
    <app-activity-card title="Total Instructors" [number]="4"></app-activity-card>
  </div>

  <div
    style="
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
      width: 100%;
      padding: 20px;
      border-radius: 10px;
      margin-top: 3%;
      display: flex;
      flex-direction: row;
      gap: 1%;
    "
  >
    <div class="input-group">
      <span class="input-group-text bg-white border-end-0">
        <img src="assets/images/search.svg" alt="search" />
      </span>
      <input class="form-control border-start-0" type="search" placeholder="Search users" />
    </div>
    <div class="dropdown flex-grow-1">
      <button class="btn dropdown-toggle custom-btn w-100" type="button" data-bs-toggle="dropdown">
        {{ selectedRole || 'All Roles' }}
      </button>
      <ul class="dropdown-menu custom-menu w-100">
        <li><a class="dropdown-item" role="button" (click)="filterByRole('')">All Roles</a></li>
        <li>
          <a class="dropdown-item" role="button" (click)="filterByRole('admin')">Instructors</a>
        </li>
        <li>
          <a class="dropdown-item" role="button" (click)="filterByRole('student')">Students</a>
        </li>
      </ul>
    </div>
  </div>

  <table class="table table-hover align-middle mt-4 custom-table">
    <thead class="table-light">
      <tr>
        <th>User</th>
        <th>Role</th>
        <th>Status</th>
        <th>Joined</th>
        <th>Courses</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let user of filteredUsers">
        <td>
          <div class="d-flex align-items-center gap-2">
            <div class="avatar">
              {{ getInitials(user.username) }}
            </div>
            <div>
              <div style="font-weight: bold">{{ user.username }}</div>
              <div style="color: grey">{{ user.email }}</div>
            </div>
          </div>
        </td>
        <td>
          <span
            [ngClass]="{
              admin: user.role == 'admin',
              student: user.role == 'student' || user.role == 'Student',
              instructor: user.role == 'instructor' || user.role == 'Instructor'
            }"
            >{{ user.role }}</span
          >
        </td>
        <td>
          <span
            class="badge active-badge"
            *ngIf="user.isActive"
            role="button"
            (click)="toggleStatus(user)"
          >
            ● active
          </span>

          <span
            class="badge inactive-badge"
            *ngIf="!user.isActive"
            role="button"
            (click)="toggleStatus(user)"
          >
            inactive
          </span>
        </td>
        <td>2020-11-11</td>
        <td>5</td>
        <td>
          <button class="btn btn-sm" (click)="deleteUser(user.id)">
            <img src="assets/images/delete.svg" alt="delete" />
          </button>
          <button class="btn btn-sm" (click)="updateUser(user.id, user)">
            <img src="assets/images/update.svg" alt="update" />
          </button>
        </td>
      </tr>
    </tbody>
  </table>
</div>

<!-- <div *ngIf="showUpdateModal" class="modal-overlay">
  <div class="modal-content">
    <h5>Update User</h5>
    <button class="close-btn" (click)="closeModal()">×</button>
    <label>Username</label>
    <input [(ngModel)]="selectedUser.username" class="form-control" />
    <label>Email</label>
    <input [(ngModel)]="selectedUser.email" class="form-control" />
    <label>Role</label>
    <select [(ngModel)]="selectedUser.role" class="form-control">
      <option value="admin">Admin</option>
      <option value="instructor">Instructor</option>
      <option value="student">Student</option>
    </select>
    <button class="btn btn-primary mt-2" (click)="saveUser()">Save</button>
  </div>
</div> -->
